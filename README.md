# 🚀 FFmpeg Ultra: xxh视频压制工具

**FFmpeg Ultra** 是一款基于 Python 和 PySide6 开发的高性能视频压制工具。 它专为追求极致效率的硬件发烧友设计，能够自动识别并榨干你电脑中 AMD、NVIDIA 或 Intel 显卡的每一分性能。

**目前只支持Windows系统**

---

## ✨ 核心特性

| 特性 | 描述 |
| --- | --- |
| **全硬件自动点火** | 启动时自动进行“点火自检”，实时探测物理显卡支持的编码引擎（AV1/HEVC/H.264）。 |
| **智能参数翻译官** | 自动识别显卡厂商（NVENC/AMF/QSV），自动将通用参数翻译为底层驱动专用的指令。 |
| **极客情报监视器** | 集成 `ffprobe` 深度探测，在黑色监视器面板实时展示源视频的编码、码率及帧率底细。 |
| **标准化预设系统** | 动态加载预设，仅展示当前硬件支持的选项，确保每一次压制都能成功。 |

---

## 🛠️ 技术栈

* **GUI 框架:** PySide6 (Qt for Python)
* **后端核心:** FFmpeg (静态打包版)
* **依赖管理:** uv (现代 Python 包管理器)
* **硬件接口:** NVIDIA NVENC, AMD AMF, Intel QSV

---

## 📦 快速开始

### 开发环境运行

如果你已经安装了 `uv`，可以极速启动：

1. 克隆项目并进入目录。
2. 确保 `ffmpeg.exe` 和 `ffprobe.exe` 位于根目录。
3. 运行：

```bash
uv run main.py

```

### 生产环境打包

本项目已适配单文件绿色版打包逻辑，通过 `uv` 即可一键生成独立 `.exe`：

```bash
uv run pyinstaller --noconfirm --onefile --windowed --add-binary "./tools/ffmpeg.exe;." --add-binary "./tools/ffprobe.exe;." --name "FFmpeg_Ultra" main.py

```

---

## 📖 使用指南

1. **启动自检**: 观察启动时的“引擎自检”弹窗，它会告诉你这台机器真实的压制实力。
2. **导入视频**: 拖入或选择视频，右侧黑屏区域将瞬间显示视频的“情报”。
3. **选择策略**:
   * 使用**预设模式**：小白一键无脑压缩。
   * 使用**自定义模式**：拖动滑块，精准控制 `CQP` 质量或 `VBR/CBR` 码率。
4. **开始压制**: 点击火箭按钮，在实时预览中见证显卡的高能时刻。

---
## 编辑预设

`./config/presets.yaml`中存放了所有预设配置。首次运行打包的`.exe`程序时会自动生成文件。具体配置信息如下

```
# 📘 开发者预设配置指南 (完整版)
# ---------------------------------------------------------------------
# 1. name:     预设在下拉菜单中显示的名称。
# 2. requires: 核心匹配词。代码会自动在【自检可用列表】中寻找包含此词的硬件引擎。
#              例如 "av1" 会匹配 "av1_nvenc" 或 "av1_qsv"。
# 3. ui_state: 定义当该预设被选中时，UI 控件应如何自动“拨动”：
#    - v_enc:    (自动填入) 视频编码器，由 requires 匹配逻辑决定。
#    - fps:      帧率。必须匹配下拉菜单中的现有字符串（如 "24", "30", "60", "保持源"）。
#    - res:      分辨率。必须匹配下拉菜单中的现有字符串（如 "720p", "1080p", "保持源"）。
#    - rc:       码率控制模式。可选 "cqp", "vbr", "cbr"。
#    - val:      控制数值。
#                - CQP 模式下：填 0-51（越小画质越好）。
#                - VBR/CBR 模式下：填目标码率整数（单位为 kbps，如 5000）。
#    - a_enc:    音频编码器。必须匹配下拉菜单字符串（如 "aac", "mp3", "copy", "an (剥离静音)"）。
#    - a_bit:    音频码率。必须匹配下拉菜单字符串（如 "128k", "192k", "320k"）。
#    - a_sample: 音频采样率。必须匹配下拉菜单字符串（如 "44100", "48000", "保持源"）。
```


## 🤝 贡献与反馈

如果你在特定的显卡型号（如最新的 RTX 50 系列或 AMD 核显）上遇到自检问题，请提交 Issue 并附带程序生成的 `hardware_report.txt`。
